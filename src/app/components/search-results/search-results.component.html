<div class="search-results-container">
  <!-- Header -->
  <div class="search-header">
    <button class="back-button" (click)="goBack()">
      <span class="material-symbols-outlined">arrow_back</span>
      Volver
    </button>
    
    <div class="search-info">
      <h1>Resultados de búsqueda</h1>
      <div class="query-display" *ngIf="!isLoading">
        <span class="query-label">Buscaste:</span>
        <span class="query-text">"{{ searchQuery }}"</span>
      </div>
      <div class="results-meta" *ngIf="!isLoading">
        <span class="results-count">{{ totalResults }} productos encontrados</span>
        <span class="execution-time" *ngIf="executionTime > 0">
          ({{ executionTime }}ms)
        </span>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Buscando productos...</p>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && searchResults.length === 0">
    <span class="material-symbols-outlined empty-icon">search_off</span>
    <h2>No se encontraron resultados</h2>
    <p>No encontramos productos que coincidan con "{{ searchQuery }}"</p>
    
    <div class="suggestions">
      <h3>Sugerencias:</h3>
      <ul>
        <li>Verifica que las palabras estén escritas correctamente</li>
        <li>Intenta con palabras más generales</li>
        <li>Intenta con menos palabras clave</li>
        <li>Explora nuestro catálogo completo</li>
      </ul>
    </div>

    <div class="empty-actions">
      <button class="btn-primary" routerLink="/catalogo">
        <span class="material-symbols-outlined">store</span>
        Ver Catálogo Completo
      </button>
      <button class="btn-secondary" routerLink="/ofertas">
        <span class="material-symbols-outlined">local_offer</span>
        Ver Ofertas
      </button>
    </div>
  </div>

  <!-- Results Grid -->
  <div class="results-grid" *ngIf="!isLoading && searchResults.length > 0">
    <div class="product-card" *ngFor="let producto of searchResults">
      <!-- Discount Badge -->
      <div class="discount-badge" *ngIf="producto.discount && producto.discount > 0">
        <span class="discount-percent">-{{ producto.discount }}%</span>
      </div>

      <!-- Product Image -->
      <div class="product-image" (click)="viewProductDetail(producto)">
        <img 
          [src]="producto.images && producto.images.length > 0 ? producto.images[0] : 'assets/placeholder.jpg'" 
          [alt]="producto.name"
          loading="lazy">
      </div>

      <!-- Product Info -->
      <div class="product-info">
        <p class="product-category">{{ producto.category.name }}</p>
        <h3 class="product-name" (click)="viewProductDetail(producto)">
          {{ producto.name }}
        </h3>
        
        <div class="product-meta">
          <div class="rating">
            <span class="material-symbols-outlined star">star</span>
            <span class="rating-value">{{ producto.rating }}</span>
            <span class="rating-count">({{ producto.reviewCount }})</span>
          </div>
          
          <div class="stock-badge" [class.in-stock]="producto.inStock" [class.out-of-stock]="!producto.inStock">
            <span class="material-symbols-outlined">
              {{ producto.inStock ? 'check_circle' : 'cancel' }}
            </span>
            <span>{{ producto.inStock ? 'Disponible' : 'Agotado' }}</span>
          </div>
        </div>

        <!-- Brand -->
        <p class="product-brand" *ngIf="producto.brand">
          <span class="material-symbols-outlined">verified</span>
          {{ producto.brand }}
        </p>

        <!-- Price Section -->
        <div class="price-section">
          <div class="price-header" *ngIf="producto.discount && producto.discount > 0">
            <span class="price-label">Precio anterior:</span>
            <span class="price-original">${{ producto.price.toLocaleString('es-MX') }}</span>
          </div>
          
          <div class="price-main">
            <span class="price-current">
              ${{ (producto.price * (1 - (producto.discount || 0) / 100)).toLocaleString('es-MX') }}
            </span>
            <span class="price-badge" *ngIf="producto.discount && producto.discount > 0">
              <span class="material-symbols-outlined">savings</span>
              Ahorras ${{ (producto.price * (producto.discount || 0) / 100).toLocaleString('es-MX') }}
            </span>
          </div>
          
          <div class="price-installments" *ngIf="producto.inStock">
            <span class="material-symbols-outlined">credit_card</span>
            <span>18x de ${{ ((producto.price * (1 - (producto.discount || 0) / 100)) / 18).toLocaleString('es-MX', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) }}</span>
          </div>
        </div>

        <!-- Action Button -->
        <button 
          class="btn-view-detail" 
          (click)="viewProductDetail(producto)"
          [disabled]="!producto.inStock">
          <span class="material-symbols-outlined">visibility</span>
          Ver Detalles
        </button>
      </div>
    </div>
  </div>
</div>
